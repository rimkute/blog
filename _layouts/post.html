<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{{ page.title }} • {{ site.title }}</title>
    <link rel="stylesheet" href="{{ "/assets/main.css" | relative_url }}">
  </head>

  <body>
    <div class="site-wrapper">

      <!-- Mobile header (only visible on small screens via CSS) -->
      <header class="mobile-header">
        <div class="mobile-title">
          <a href="{{ "/" | relative_url }}">{{ site.title }}</a>
        </div>
        <button class="mobile-menu-toggle" aria-label="Toggle navigation">☰</button>
      </header>

      <div class="layout">
        <!-- SIDEBAR -->
        <aside class="sidebar">
          <h1 class="site-title">
            <a href="{{ "/" | relative_url }}">{{ site.title }}</a>
          </h1>

          <nav class="sidebar-nav">
            <ul>
              <!-- ABOUT -->
              <li class="{% if page.url == '/about/' %}active{% endif %}">
                <a href="{{ '/about/' | relative_url }}">ABOUT</a>
              </li>

              <!-- LOOP ALL POSTS (newest first, sorted by date) -->
              {% assign sorted_posts = site.posts | sort: 'date' | reverse %}
              {% for post in sorted_posts %}
                <li class="{% if page.url == post.url %}active{% endif %}">
                  <a href="{{ post.url | relative_url }}">
                    {{ post.nav_title | default: post.title }}
                  </a>
                </li>
              {% endfor %}
            </ul>
          </nav>
        </aside>

        <!-- MAIN CONTENT -->
        <main class="site-content">
          <h2 class="page-title">{{ page.title }}</h2>

          {% if page.featured_image %}
            <div class="post-hero">
              <img src="{{ page.featured_image | relative_url }}"
                   alt="{{ page.title }}">
            </div>
          {% endif %}

          <article class="post-content">
            {{ content }}
          </article>
        </main>
      </div>

      <!-- Overlay used when mobile sidebar is open -->
      <div class="mobile-overlay"></div>
    </div>

    <script>
      (function () {
        const toggle  = document.querySelector('.mobile-menu-toggle');
        const sidebar = document.querySelector('.sidebar');
        const overlay = document.querySelector('.mobile-overlay');

        if (!toggle || !sidebar) return;

        function closeMenu() {
          sidebar.classList.remove('open');
          document.body.classList.remove('sidebar-open');
          if (overlay) overlay.classList.remove('visible');
        }

        toggle.addEventListener('click', function () {
          const isOpen = sidebar.classList.toggle('open');
          document.body.classList.toggle('sidebar-open', isOpen);
          if (overlay) overlay.classList.toggle('visible', isOpen);
        });

        if (overlay) {
          overlay.addEventListener('click', closeMenu);
        }

        window.addEventListener('resize', function () {
          if (window.innerWidth > 900) {
            closeMenu();
          }
        });
      })();
    </script>
  </body>
</html>
